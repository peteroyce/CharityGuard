<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Nonprofit - CharityGuard</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>üõ°Ô∏è CharityGuard</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">Home</a></li>
                <li><a href="dashboard.html" class="nav-link">Dashboard</a></li>
                <li><a href="nonprofits.html" class="nav-link active">Nonprofits</a></li>
                <li><a href="transactions.html" class="nav-link">Transactions</a></li>
                <li><a href="analytics.html" class="nav-link">Analytics</a></li>
            </ul>
        </div>
    </nav>

    <main style="margin-top: 100px; padding: 2rem;">
        <div class="container">
            <h1>Register New Nonprofit Organization</h1>
            <form id="nonprofit-form">
                <label for="ein">EIN (Tax ID Number):</label>
                <input type="text" id="ein" name="ein" maxlength="20" required placeholder="12-3456789">

                <label for="name">Organization Name:</label>
                <input type="text" id="name" name="name" maxlength="200" required>

                <label for="contactEmail">Contact Email:</label>
                <input type="email" id="contactEmail" name="contactEmail" required>

                <label for="address">Address:</label>
                <input type="text" id="address" name="address" placeholder="Optional">

                <button type="submit" class="btn-primary">Register &amp; Verify Against IRS Database</button>
            </form>

            <div id="verification-result"></div>

            <div class="card bg-light">
                <h3>üìÇ IRS Database Integration</h3>
                <p>Our system verifies EINs against <strong>559,125+</strong> official IRS records.</p>
                <p><em>Live demonstration with simulated IRS verification responses</em></p>
            </div>

            <div class="card">
                <h2>Registered Organizations</h2>
                <div id="registered-list">
                    <div class="card" style="border-left: 5px solid #28a745; margin-bottom: 1rem;">
                        <h4>American Red Cross</h4>
                        <p><strong>EIN:</strong> 53-0196605</p>
                        <p><strong>Email:</strong> demo@redcross.org</p>
                        <p><strong>Status:</strong> <span class="verification-badge verified">‚úÖ IRS VERIFIED</span></p>
                        <p><strong>Address:</strong> 431 18th St NW, Washington, DC 20006</p>
                    </div>
                    <div class="card" style="border-left: 5px solid #28a745; margin-bottom: 1rem;">
                        <h4>Doctors Without Borders USA</h4>
                        <p><strong>EIN:</strong> 13-3433452</p>
                        <p><strong>Email:</strong> demo@doctorswithoutborders.org</p>
                        <p><strong>Status:</strong> <span class="verification-badge verified">‚úÖ IRS VERIFIED</span></p>
                        <p><strong>Address:</strong> 40 Rector St, New York, NY 10006</p>
                    </div>
                    <div class="card" style="border-left: 5px solid #ffc107; margin-bottom: 1rem;">
                        <h4>Suspicious Relief Fund</h4>
                        <p><strong>EIN:</strong> 99-9999999</p>
                        <p><strong>Email:</strong> scam@suspicious.org</p>
                        <p><strong>Status:</strong> <span class="verification-badge pending">‚ö†Ô∏è PENDING</span></p>
                        <p><strong>Address:</strong> 123 Unknown St, Nowhere, XX 00000</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Demo data - verified EINs that will show as legitimate
        const verifiedEINs = {
            '53-0196605': 'American Red Cross',
            '13-3433452': 'Doctors Without Borders USA',
            '13-1788491': 'American Cancer Society',
            '13-1624107': 'United Way Worldwide',
            '13-1623361': 'Salvation Army',
            '13-5613797': 'American Heart Association',
            '35-1044585': 'St. Jude Children\'s Research Hospital',
            '13-1760110': 'UNICEF USA',
            '95-1922279': 'World Vision',
            '23-7026820': 'Oxfam America'
        };

        // Registered organizations list (simulated database)
        let registeredOrganizations = [
            {
                name: 'American Red Cross',
                registrationNumber: '53-0196605',
                contactEmail: 'demo@redcross.org',
                address: '431 18th St NW, Washington, DC 20006',
                verificationStatus: 'verified'
            },
            {
                name: 'Doctors Without Borders USA',
                registrationNumber: '13-3433452',
                contactEmail: 'demo@doctorswithoutborders.org',
                address: '40 Rector St, New York, NY 10006',
                verificationStatus: 'verified'
            },
            {
                name: 'Suspicious Relief Fund',
                registrationNumber: '99-9999999',
                contactEmail: 'scam@suspicious.org',
                address: '123 Unknown St, Nowhere, XX 00000',
                verificationStatus: 'pending'
            }
        ];

        document.getElementById('nonprofit-form').addEventListener('submit', async e => {
            e.preventDefault();

            const formData = {
                ein: document.getElementById('ein').value.trim(),
                name: document.getElementById('name').value.trim(),
                contactEmail: document.getElementById('contactEmail').value.trim(),
                address: document.getElementById('address').value.trim()
            };

            // Show processing message
            document.getElementById('verification-result').innerHTML = 
                '<div class="card"><h3>üîÑ Verifying against IRS database...</h3><p>Checking EIN ' + formData.ein + ' against 559,125+ official records...</p></div>';

            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Check if EIN is in verified list
            const isVerified = verifiedEINs.hasOwnProperty(formData.ein);
            const verificationStatus = isVerified ? 'verified' : 'pending';
            const suggestedName = verifiedEINs[formData.ein] || formData.name;

            // Create result object
            const result = {
                name: suggestedName,
                registrationNumber: formData.ein,
                contactEmail: formData.contactEmail,
                address: formData.address,
                verificationStatus: verificationStatus,
                trustLevel: isVerified ? 'trusted' : 'new',
                trustScore: isVerified ? 0.95 : 0.25
            };

            // Add to registered organizations if not already exists
            const existingIndex = registeredOrganizations.findIndex(org => org.registrationNumber === formData.ein);
            if (existingIndex === -1) {
                registeredOrganizations.unshift(result);
            }

            // Display result
            const badgeClass = isVerified ? 'verified' : 'pending';
            const statusText = isVerified ? 'IRS VERIFIED' : 'PENDING VERIFICATION';
            const bgColor = isVerified ? '#d4edda' : '#fff3cd';
            const borderColor = isVerified ? '#28a745' : '#ffc107';

            document.getElementById('verification-result').innerHTML = 
                '<div class="card" style="background: ' + bgColor + '; border-left: 5px solid ' + borderColor + ';">' +
                    '<h3>' + (isVerified ? '‚úÖ' : '‚ö†Ô∏è') + ' Registration Complete</h3>' +
                    '<p><strong>Organization:</strong> ' + result.name + '</p>' +
                    '<p><strong>EIN:</strong> ' + result.registrationNumber + '</p>' +
                    '<p><strong>Status:</strong> <span class="verification-badge ' + badgeClass + '">' + statusText + '</span></p>' +
                    '<p><strong>Trust Score:</strong> ' + (result.trustScore * 100).toFixed(1) + '%</p>' +
                    (isVerified ? 
                        '<p style="color: #155724;"><strong>‚úÖ Verified against official IRS records!</strong></p><p>This organization is registered with the IRS as a tax-exempt entity.</p>' : 
                        '<p style="color: #856404;"><strong>‚ö†Ô∏è EIN not found in IRS database. Manual review required.</strong></p><p>This EIN does not appear in our database of 559,125+ official IRS records.</p>') +
                '</div>';

            // Clear form
            e.target.reset();
            
            // Refresh registered list
            updateRegisteredList();
        });

        function updateRegisteredList() {
            let html = '';
            for (let org of registeredOrganizations) {
                const isVerified = org.verificationStatus === 'verified';
                const badgeClass = isVerified ? 'verified' : 'pending';
                const borderColor = isVerified ? '#28a745' : '#ffc107';
                const statusText = isVerified ? '‚úÖ IRS VERIFIED' : '‚ö†Ô∏è PENDING';
                
                html += '<div class="card" style="border-left: 5px solid ' + borderColor + '; margin-bottom: 1rem;">' +
                    '<h4>' + org.name + '</h4>' +
                    '<p><strong>EIN:</strong> ' + org.registrationNumber + '</p>' +
                    '<p><strong>Email:</strong> ' + org.contactEmail + '</p>' +
                    '<p><strong>Status:</strong> <span class="verification-badge ' + badgeClass + '">' + statusText + '</span></p>' +
                    (org.address ? '<p><strong>Address:</strong> ' + org.address + '</p>' : '') +
                '</div>';
            }
            document.getElementById('registered-list').innerHTML = html;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateRegisteredList();
        });
    </script>
</body>
</html>